import{r as l,A as _,j as i,L as v,p as E,n as j,P as y,c as h,a as B}from"./index-nYtYs2K7.js";import{u as C,L}from"./use-favorites-0KNEGb7x.js";import{S as p}from"./small_preloader-kHzfl4we.js";const w=l.createContext(null),g={didCatch:!1,error:null};class R extends l.Component{constructor(e){super(e),this.resetErrorBoundary=this.resetErrorBoundary.bind(this),this.state=g}static getDerivedStateFromError(e){return{didCatch:!0,error:e}}resetErrorBoundary(){const{error:e}=this.state;if(e!==null){for(var t,s,o=arguments.length,a=new Array(o),n=0;n<o;n++)a[n]=arguments[n];(t=(s=this.props).onReset)===null||t===void 0||t.call(s,{args:a,reason:"imperative-api"}),this.setState(g)}}componentDidCatch(e,t){var s,o;(s=(o=this.props).onError)===null||s===void 0||s.call(o,e,t)}componentDidUpdate(e,t){const{didCatch:s}=this.state,{resetKeys:o}=this.props;if(s&&t.error!==null&&I(e.resetKeys,o)){var a,n;(a=(n=this.props).onReset)===null||a===void 0||a.call(n,{next:o,prev:e.resetKeys,reason:"keys"}),this.setState(g)}}render(){const{children:e,fallbackRender:t,FallbackComponent:s,fallback:o}=this.props,{didCatch:a,error:n}=this.state;let u=e;if(a){const f={error:n,resetErrorBoundary:this.resetErrorBoundary};if(typeof t=="function")u=t(f);else if(s)u=l.createElement(s,f);else if(o===null||l.isValidElement(o))u=o;else throw n}return l.createElement(w.Provider,{value:{didCatch:a,error:n,resetErrorBoundary:this.resetErrorBoundary}},u)}}function I(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return r.length!==e.length||r.some((t,s)=>!Object.is(t,e[s]))}const N="_figure_3cmdt_1",k="_img_3cmdt_33",P="_figcaption_3cmdt_42",S="_infoButton_3cmdt_65",m={figure:N,img:k,figcaption:P,infoButton:S},x=l.memo(r=>{const{isAuth:e}=l.useContext(_),{isFavorite:t,isLoading:s,handleFavoriteButtonClick:o}=C(r.photoInfo.id);return i.jsxs("figure",{className:m.figure,children:[i.jsx("img",{className:m.img,src:r.photoInfo.url,alt:r.photoInfo.alt_description}),i.jsxs("figcaption",{className:m.figcaption,children:[i.jsx(v,{to:`${E.homePage}photos/${r.photoInfo.id}`,className:m.infoButton,children:"Больше информации"}),e&&(s?i.jsx(p,{width:50}):i.jsx(L,{isFavorite:t,handleFavoriteButtonClick:o}))]})]})}),D="_list_ou4us_1",F="_listItem_ou4us_12",b="_listItemLarge_ou4us_19 _listItem_ou4us_12",d={list:D,listItem:F,listItemLarge:b},A=l.memo(r=>{const{data:e,isLoading:t,error:s}=j(r.id);if(s)if("status"in s){const o="error"in s?s.error:JSON.stringify(s.data);throw new Error(o)}else{const o=s.message;throw new Error(o)}return t?i.jsx(y,{}):e&&i.jsx("li",{className:h(d.listItem,{[d.listItemLarge]:e.width<e.height}),children:i.jsx(x,{photoInfo:e})},e.id)}),U=l.memo(r=>{var e;if(r.error)if("status"in r.error){const t="error"in r.error?r.error.error:JSON.stringify(r.error.data);throw new Error(t)}else{const t=r.error.message;throw new Error(t)}return i.jsx("ul",{className:d.list,children:r.photoList?r.photoList.map(t=>i.jsx("li",{className:h(d.listItem,{[d.listItemLarge]:t.width<t.height}),children:i.jsx(x,{photoInfo:t})},t.id)):(e=r.favoritesList)==null?void 0:e.map(t=>i.jsx(A,{id:t},t))})}),M="_container_i6sv3_1",K="_title_i6sv3_8",O="_text_i6sv3_17",J="_textDark_i6sv3_21",c={container:M,title:K,text:O,textDark:J},V=()=>{const{theme:r}=B();return i.jsxs("div",{className:c.container,children:[i.jsx("p",{className:c.title,children:"Ошибка!"}),i.jsx("p",{className:h(c.text,{[c.textDark]:r==="dark"}),children:"На сайте произошла ошибка, мы уже начали разбираться с ней."}),i.jsx("p",{className:h(c.text,{[c.textDark]:r==="dark"}),children:"Приносим извинения за временные неудобства."})]})};export{R as E,V as F,U as P};
